<!doctype html>

<html>
    <div class = "main_container">
        <link rel="stylesheet" href="styles.css">
        <div class= "intestazione">
             <div class = "logo"><center>logo</center></div>
             <div class = "nome"><center>nome</center></div>
        </div>
    

    
        <div class = "ricerca">
            <textarea id = "barraRicerca" name = "barraRicerca" rows = "1"  columns = "30"></textarea>
            <input name = "bottoneRicerca" type = "button" onclick = "cercaLuogo();" value = "cerca" class = "pulsanteRicerca">
        </div>
        <div class = "risultati">
            <div class = "allarme">
                allarme:<br><br>
                <img src="idle_pic.jpg" height = "80%" width = "80%" id = "ALLARME">
            </div>
            <div class = "risultatiRicerca">
                <p id = "area_risultati">mieo</p>
            </div>
        </div>
        
    </div>

</html>

<script>
//onclick='updateAllarme(this);'
var statoAllarme = 0; //0 = idle, 1 = no pericolo, 2 = si pericolo

function updateAllarme() {
    if(statoAllarme == 0){
        document.getElementById("ALLARME").src = "idle_pic.jpg";
        //document.getElementById("area_risultati").innerHTML = "guarda qui a sinistra"
    }else if(statoAllarme == 1){
        document.getElementById("ALLARME").src = "NESSUN_RISCHIO.jpg";
    }else if(statoAllarme == 2){
        document.getElementById("ALLARME").src = "ATTENTO.jpg";
        statoAllarme = -1;
    }
}

function cercaLuogo(){
    const citta = document.getElementById("barraRicerca").value;
    const apiUrl = 'https://api.weatherapi.com/v1/current.json?key=50aeef4823b642bfa16171055241012&q=' + citta + '&aqi=no';

    fetch(apiUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            const temperature = data.current.temp_c;
            const humidity = data.humidity;
            console.log("temp: &{temperature}, humi: &{humidity}\n");
            if(temperature < 5.5 && humidity > 50){
                statoAllarme = 2;
            }else{
                statoAllarme = 1;
            }
        })
        .catch(error => {
            alert('Error:', error);
        });



    updateAllarme()

}

</script>
